<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>shiftlefter.repl documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">ShiftLefter</span> <span class="project-version">0.3.6-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shiftlefter</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>adapters</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.adapters.etaoin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>etaoin</span></div></a></li><li class="depth-3"><a href="shiftlefter.adapters.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>browser</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.browser.chrome.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chrome</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.browser.ctx.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ctx</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.browser.locators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>locators</span></div></a></li><li class="depth-3"><a href="shiftlefter.browser.protocol.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocol</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>capabilities</span></div></div></li><li class="depth-3"><a href="shiftlefter.capabilities.ctx.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ctx</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>config</span></div></div></li><li class="depth-3"><a href="shiftlefter.config.user.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>user</span></div></a></li><li class="depth-2 branch"><a href="shiftlefter.core.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gherkin</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.compliance.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compliance</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.ddmin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ddmin</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.diagnostics.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>diagnostics</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.dialect.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dialect</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.fuzz.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fuzz</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.lexer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lexer</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.location.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>location</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.parser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parser</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.pickler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pickler</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.printer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>printer</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.tokens.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tokens</span></div></a></li><li class="depth-3"><a href="shiftlefter.gherkin.verify.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>verify</span></div></a></li><li class="depth-2 branch current"><a href="shiftlefter.repl.html"><div class="inner"><span class="tree" style="top: -455px;"><span class="top" style="height: 464px;"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>runner</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.runner.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.runner.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.runner.discover.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>discover</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.runner.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>report</span></div></div></li><li class="depth-4 branch"><a href="shiftlefter.runner.report.console.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>console</span></div></a></li><li class="depth-4"><a href="shiftlefter.runner.report.edn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>edn</span></div></a></li><li class="depth-3"><a href="shiftlefter.runner.step-loader.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>step-loader</span></div></a></li><li class="depth-2 branch"><a href="shiftlefter.step.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>step</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stepdefs</span></div></div></li><li class="depth-3"><a href="shiftlefter.stepdefs.browser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>browser</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>stepengine</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.stepengine.bind.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bind</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.stepengine.compile.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compile</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.stepengine.exec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exec</span></div></a></li><li class="depth-3"><a href="shiftlefter.stepengine.macros.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>macros</span></div></a></li><li class="depth-4"><a href="shiftlefter.stepengine.macros.ini.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ini</span></div></a></li><li class="depth-3"><a href="shiftlefter.stepengine.registry.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-2"><a href="shiftlefter.subjects.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>subjects</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.subjects.browser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>browser</span></div></a></li><li class="depth-3"><a href="shiftlefter.subjects.profile.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>profile</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>svo</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.svo.extract.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extract</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.svo.glossary.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>glossary</span></div></a></li><li class="depth-3"><a href="shiftlefter.svo.validate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>validate</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>webdriver</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>etaoin</span></div></div></li><li class="depth-4 branch"><a href="shiftlefter.webdriver.etaoin.browser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>browser</span></div></a></li><li class="depth-4"><a href="shiftlefter.webdriver.etaoin.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-3"><a href="shiftlefter.webdriver.session-store.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>session-store</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="shiftlefter.repl.html#var-*session-store*"><div class="inner"><span>*session-store*</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-as"><div class="inner"><span>as</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-clear.21"><div class="inner"><span>clear!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-config"><div class="inner"><span>config</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-connect-persistent-subject.21"><div class="inner"><span>connect-persistent-subject!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-ctx"><div class="inner"><span>ctx</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-ctxs"><div class="inner"><span>ctxs</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-destroy-persistent-subject.21"><div class="inner"><span>destroy-persistent-subject!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-get-repl-config"><div class="inner"><span>get-repl-config</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-glossary"><div class="inner"><span>glossary</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-init-persistent-subject.21"><div class="inner"><span>init-persistent-subject!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-interfaces"><div class="inner"><span>interfaces</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-list-persistent-subjects"><div class="inner"><span>list-persistent-subjects</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-list-surfaces"><div class="inner"><span>list-surfaces</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-mark-surface.21"><div class="inner"><span>mark-surface!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-parse-only"><div class="inner"><span>parse-only</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-reset-ctx.21"><div class="inner"><span>reset-ctx!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-reset-ctxs.21"><div class="inner"><span>reset-ctxs!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-reset-surfaces.21"><div class="inner"><span>reset-surfaces!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-run"><div class="inner"><span>run</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-run-dry"><div class="inner"><span>run-dry</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-set-ctx.21"><div class="inner"><span>set-ctx!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-shifted.21"><div class="inner"><span>shifted!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-shifted.3F"><div class="inner"><span>shifted?</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-step"><div class="inner"><span>step</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-steps"><div class="inner"><span>steps</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-subjects"><div class="inner"><span>subjects</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-surface.3F"><div class="inner"><span>surface?</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-unmark-surface.21"><div class="inner"><span>unmark-surface!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-vanilla.21"><div class="inner"><span>vanilla!</span></div></a></li><li class="depth-1"><a href="shiftlefter.repl.html#var-verbs"><div class="inner"><span>verbs</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">shiftlefter.repl</h1><div class="doc"><div class="markdown"><p>REPL utilities for interactive Gherkin execution.</p>
<h2><a href="#quick-start" id="quick-start"></a>Quick Start</h2>
<pre><code class="language-clojure">(require '[shiftlefter.repl :as repl])
(require '[shiftlefter.stepengine.registry :refer [defstep]])

;; Define steps
(defstep #"I have (\d+) cucumbers" [n]
  (println "Starting with" n "cucumbers"))

(defstep #"I eat (\d+)" [n]
  (println "Eating" n))

(defstep #"I should have (\d+) left" [n]
  (println "Checking for" n "left"))

;; Run Gherkin text (full Feature/Scenario structure)
(repl/run "
  Feature: Cucumbers
    Scenario: Eating
      Given I have 12 cucumbers
      When I eat 5
      Then I should have 7 left")

;; Or use step mode (no Feature/Scenario wrapper needed)
(repl/step "I have 12 cucumbers")
(repl/step "I eat 5")
(repl/step "I should have 7 left")
</code></pre>
<h2><a href="#functions" id="functions"></a>Functions</h2>
<h3><a href="#structured-mode-requires-featurescenario" id="structured-mode-requires-featurescenario"></a>Structured Mode (requires Feature/Scenario)</h3>
<ul>
<li><code>run</code>        — parse and execute Gherkin text</li>
<li><code>run-dry</code>    — parse and bind only (no execution)</li>
<li><code>parse-only</code> — just parse, return pickles</li>
</ul>
<h3><a href="#step-mode-steps-only-no-structure" id="step-mode-steps-only-no-structure"></a>Step Mode (steps only, no structure)</h3>
<ul>
<li><code>step</code>       — execute a single step, maintains session context</li>
<li><code>as</code>         — execute steps in named context (multi-actor sessions)</li>
<li><code>ctx</code>        — inspect session context (or named context)</li>
<li><code>ctxs</code>       — inspect all named contexts</li>
<li><code>set-ctx!</code>   — set a named context to a value (e.g., attach browser)</li>
<li><code>reset-ctx!</code> — reset session context to empty</li>
<li><code>reset-ctxs!</code>— reset all named contexts</li>
</ul>
<h3><a href="#surfaces-opt-in-browser-session-persistence" id="surfaces-opt-in-browser-session-persistence"></a>Surfaces (opt-in browser session persistence)</h3>
<ul>
<li><code>mark-surface!</code>   — mark context as surface (persist on reset)</li>
<li><code>unmark-surface!</code> — unmark context as surface</li>
<li><code>surface?</code>        — check if context is marked as surface</li>
<li><code>list-surfaces</code>   — list all marked surfaces</li>
<li><code>reset-surfaces!</code> — clear all surface markings</li>
</ul>
<h3><a href="#persistent-subjects-chrome-owned-sessions-that-survive-jvm-restarts" id="persistent-subjects-chrome-owned-sessions-that-survive-jvm-restarts"></a>Persistent Subjects (Chrome-owned sessions that survive JVM restarts)</h3>
<ul>
<li><code>init-persistent-subject!</code>    — create new persistent subject</li>
<li><code>connect-persistent-subject!</code> — reconnect to existing subject</li>
<li><code>destroy-persistent-subject!</code> — kill Chrome and delete profile</li>
<li><code>list-persistent-subjects</code>    — list all subjects with status</li>
</ul>
<h3><a href="#utilities" id="utilities"></a>Utilities</h3>
<ul>
<li><code>steps</code>      — list registered step patterns</li>
<li><code>clear!</code>     — clear step registry, contexts, and surfaces</li>
</ul>
</div></div><div class="public anchor" id="var-*session-store*"><h3>*session-store*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Delay containing the session store for surface persistence. Surfaces use this store to save/load browser session handles across resets. Bind with a custom store for testing; default uses EDN file-based store.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L94">view source</a></div></div><div class="public anchor" id="var-as"><h3>as</h3><div class="usage"><code>(as ctx-name &amp; steps)</code></div><div class="doc"><div class="markdown"><p>Execute steps in a named context; fail-fast per call.</p>
<p>Each named context maintains its own accumulated state, allowing simulation of multiple users/actors.</p>
<p>Automatically prepends <code>:ctx-name</code> to each step text, so the step matches subject-extracting patterns. For example:</p>
<pre><code class="language-clojure">(as :alice "opens the browser to 'https://example.com'")
</code></pre>
<p>becomes step text <code>:alice opens the browser to 'https://example.com'</code> which matches the built-in browser step pattern.</p>
<p>If the step text already starts with <code>:ctx-name</code>, no prepending occurs (idempotent — you can also write the full step text explicitly).</p>
<p>In Shifted mode with <code>:unknown-subject :warn</code>, warns but proceeds. In Shifted mode with <code>:unknown-subject :error</code>, returns error without executing.</p>
<p>Parameters: - ctx-name: keyword identifying the context (e.g., :alice, :bob) - steps: one or more step text strings</p>
<p>Returns result of last step, with :session and :ctx keys. Stops on first non-passing step (fail-fast).</p>
<p>Example:</p>
<pre><code class="language-clojure">(as :alice "opens the browser to 'https://example.com'")
(as :alice "clicks {:id \"login\"}")
(as :alice "should see 'Welcome'")

;; Also works with explicit subject (idempotent):
(as :alice ":alice opens the browser to 'https://example.com'")

;; Check all contexts
(ctxs)

;; Check specific context
(ctx :alice)
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L622">view source</a></div></div><div class="public anchor" id="var-clear.21"><h3>clear!</h3><div class="usage"><code>(clear!)</code></div><div class="doc"><div class="markdown"><p>Clear the step registry, session context, named contexts, and surface markings.</p>
<p>Before clearing, handles browser session cleanup: - Non-surface contexts: browser session is closed - Surface contexts: browser session is detached and persisted</p>
<p>Note: Does NOT destroy persistent subjects. Use <code>destroy-persistent-subject!</code> for that.</p>
<p>Useful when redefining steps in REPL.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L471">view source</a></div></div><div class="public anchor" id="var-config"><h3>config</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Alias for <code>get-repl-config</code>. Returns current REPL config (nil if vanilla mode).</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L267">view source</a></div></div><div class="public anchor" id="var-connect-persistent-subject.21"><h3>connect-persistent-subject!</h3><div class="usage"><code>(connect-persistent-subject! subject-name)</code></div><div class="doc"><div class="markdown"><p>Connect to an existing persistent subject.</p>
<p>Use this after JVM restart to reconnect to a Chrome instance that was previously initialized with <code>init-persistent-subject!</code>.</p>
<p>If Chrome is still running, creates a new WebDriver session. If Chrome died, relaunches it automatically.</p>
<p>Returns: - Success: <code>{:status :connected :subject &lt;name&gt; :port &lt;int&gt; :pid &lt;long&gt; :browser &lt;PersistentBrowser&gt;}</code> - Error: <code>{:error {:type :subject/... ...}}</code></p>
<p>Example:</p>
<pre><code class="language-clojure">;; After JVM restart
(connect-persistent-subject! :finance)
;; =&gt; {:status :connected :subject :finance :port 9222 ...}
</code></pre>
<p>See <code>shiftlefter.subjects/connect-persistent!</code> for full documentation.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L725">view source</a></div></div><div class="public anchor" id="var-ctx"><h3>ctx</h3><div class="usage"><code>(ctx)</code><code>(ctx name)</code></div><div class="doc"><div class="markdown"><p>Get the current session context (or a named context).</p>
<p>In step mode, context accumulates across step calls. Step functions returning maps merge into this context.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L104">view source</a></div></div><div class="public anchor" id="var-ctxs"><h3>ctxs</h3><div class="usage"><code>(ctxs)</code></div><div class="doc"><div class="markdown"><p>Get all named contexts as a map.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L112">view source</a></div></div><div class="public anchor" id="var-destroy-persistent-subject.21"><h3>destroy-persistent-subject!</h3><div class="usage"><code>(destroy-persistent-subject! subject-name)</code></div><div class="doc"><div class="markdown"><p>Destroy a persistent subject.</p>
<p>Kills the Chrome process and deletes the entire profile directory (including Chrome user data like cookies, history, etc.).</p>
<p>Returns: - Success: <code>{:status :destroyed :subject &lt;name&gt;}</code> - Error: <code>{:error {:type :subject/not-found ...}}</code></p>
<p>Example:</p>
<pre><code class="language-clojure">(destroy-persistent-subject! :finance)
;; =&gt; {:status :destroyed :subject :finance}
</code></pre>
<p>See <code>shiftlefter.subjects/destroy-persistent!</code> for full documentation.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L752">view source</a></div></div><div class="public anchor" id="var-get-repl-config"><h3>get-repl-config</h3><div class="usage"><code>(get-repl-config)</code></div><div class="doc"><div class="markdown"><p>Get the current REPL config (nil if vanilla mode).</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L262">view source</a></div></div><div class="public anchor" id="var-glossary"><h3>glossary</h3><div class="usage"><code>(glossary)</code></div><div class="doc"><div class="markdown"><p>Get the loaded glossary for the current Shifted mode config.</p>
<p>Returns the merged glossary map (defaults + project glossaries), or nil if not in Shifted mode or no glossaries configured.</p>
<p>Example:</p>
<pre><code class="language-clojure">(shifted! {:glossaries {:subjects "path/to/subjects.edn"}})
(glossary)
;; =&gt; {:subjects {:alice {...} :admin {...}} :verbs {:web {...}}}
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L271">view source</a></div></div><div class="public anchor" id="var-init-persistent-subject.21"><h3>init-persistent-subject!</h3><div class="usage"><code>(init-persistent-subject! subject-name)</code><code>(init-persistent-subject! subject-name opts)</code></div><div class="doc"><div class="markdown"><p>Initialize a new persistent browser subject.</p>
<p>Creates a Chrome instance with its own profile that survives JVM restarts. The browser auto-reconnects on session errors (e.g., after sleep/wake).</p>
<p>Options: - <code>:stealth</code> — if true, use anti-detection flags (default: false) - <code>:chrome-path</code> — explicit Chrome binary path (default: auto-detect)</p>
<p>Returns: - Success: <code>{:status :connected :subject &lt;name&gt; :port &lt;int&gt; :pid &lt;long&gt; :browser &lt;PersistentBrowser&gt;}</code> - Error: <code>{:error {:type :subject/... ...}}</code></p>
<p>Example:</p>
<pre><code class="language-clojure">(init-persistent-subject! :finance {:stealth true})
;; =&gt; {:status :connected :subject :finance :port 9222 ...}
</code></pre>
<p>See <code>shiftlefter.subjects/init-persistent!</code> for full documentation.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L696">view source</a></div></div><div class="public anchor" id="var-interfaces"><h3>interfaces</h3><div class="usage"><code>(interfaces)</code></div><div class="doc"><div class="markdown"><p>Get known interface types from the glossary.</p>
<p>Returns a vector of interface keywords (e.g., <a href=":web :api">:web :api</a>), or nil if not in Shifted mode.</p>
<p>Example:</p>
<pre><code class="language-clojure">(shifted! {:glossaries {:verbs {:web "..." :api "..."}}})
(interfaces)
;; =&gt; [:web :api]
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L327">view source</a></div></div><div class="public anchor" id="var-list-persistent-subjects"><h3>list-persistent-subjects</h3><div class="usage"><code>(list-persistent-subjects)</code></div><div class="doc"><div class="markdown"><p>List all persistent subjects with their status.</p>
<p>Returns a vector of subject info maps:</p>
<pre><code class="language-clojure">[{:name "finance"
  :status :alive      ; or :dead, :unknown
  :port 9222
  :pid 12345
  :meta {...}}]
</code></pre>
<p>Example:</p>
<pre><code class="language-clojure">(list-persistent-subjects)
;; =&gt; [{:name "finance" :status :alive :port 9222 ...}]
</code></pre>
<p>See <code>shiftlefter.subjects/list-persistent</code> for full documentation.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L775">view source</a></div></div><div class="public anchor" id="var-list-surfaces"><h3>list-surfaces</h3><div class="usage"><code>(list-surfaces)</code></div><div class="doc"><div class="markdown"><p>List all context names currently marked as surfaces.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L194">view source</a></div></div><div class="public anchor" id="var-mark-surface.21"><h3>mark-surface!</h3><div class="usage"><code>(mark-surface! ctx-name)</code></div><div class="doc"><div class="markdown"><p>Mark a context name as a surface (opt-in session persistence).</p>
<p>Surfaces are browser sessions that persist across REPL reset/clear. When a surface ctx is reset, the session is detached (not closed) and persisted to disk for later reattachment.</p>
<p>Note: Only named contexts can be surfaces. Note: Multi-process attach is not supported (no locking).</p>
<p>Example:</p>
<pre><code class="language-clojure">(mark-surface! :alice)
(as :alice "opens the browser to 'https://example.com'")
(reset-ctxs!)  ; session persisted, not closed
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L160">view source</a></div></div><div class="public anchor" id="var-parse-only"><h3>parse-only</h3><div class="usage"><code>(parse-only text)</code></div><div class="doc"><div class="markdown"><p>Parse Gherkin text and return pickles.</p>
<p>Returns: - {:status :ok :pickles <a href="...">…</a>} - {:status :parse-error :errors <a href="...">…</a>}</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L385">view source</a></div></div><div class="public anchor" id="var-reset-ctx.21"><h3>reset-ctx!</h3><div class="usage"><code>(reset-ctx!)</code><code>(reset-ctx! new-ctx)</code></div><div class="doc"><div class="markdown"><p>Reset session context to empty map (or provided value).</p>
<p>Returns the new context.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L117">view source</a></div></div><div class="public anchor" id="var-reset-ctxs.21"><h3>reset-ctxs!</h3><div class="usage"><code>(reset-ctxs!)</code></div><div class="doc"><div class="markdown"><p>Reset all named contexts.</p>
<p>Before resetting, handles browser session cleanup: - Non-surface contexts: browser session is closed - Surface contexts: browser session is detached and persisted</p>
<p>Returns vector of cleanup actions taken.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L124">view source</a></div></div><div class="public anchor" id="var-reset-surfaces.21"><h3>reset-surfaces!</h3><div class="usage"><code>(reset-surfaces!)</code></div><div class="doc"><div class="markdown"><p>Clear all surface markings.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L199">view source</a></div></div><div class="public anchor" id="var-run"><h3>run</h3><div class="usage"><code>(run text)</code></div><div class="doc"><div class="markdown"><p>Parse and execute Gherkin text.</p>
<p>Assumes step definitions are already loaded via <code>defstep</code>.</p>
<p>In Shifted mode (see <code>shifted!</code>), SVO validation is performed.</p>
<p>Returns: - {:status :ok :results {…} :summary {…}} - {:status :parse-error :errors <a href="...">…</a>} - {:status :bind-error :diagnostics {…}}</p>
<p>Example:</p>
<pre><code class="language-clojure">(run "
  Feature: Math
    Scenario: Addition
      Given I have 5
      When I add 3
      Then I get 8")
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L426">view source</a></div></div><div class="public anchor" id="var-run-dry"><h3>run-dry</h3><div class="usage"><code>(run-dry text)</code></div><div class="doc"><div class="markdown"><p>Parse and bind Gherkin text without executing.</p>
<p>Useful for checking step definitions match.</p>
<p>In Shifted mode (see <code>shifted!</code>), SVO validation is performed.</p>
<p>Returns: - {:status :ok :plans <a href="...">…</a> :diagnostics {…}} - {:status :parse-error :errors <a href="...">…</a>} - {:status :bind-error :diagnostics {…}}</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L398">view source</a></div></div><div class="public anchor" id="var-set-ctx.21"><h3>set-ctx!</h3><div class="usage"><code>(set-ctx! ctx-name ctx-value)</code></div><div class="doc"><div class="markdown"><p>Set a named context to a specific value.</p>
<p>Use this to attach a browser or other state to a context before running steps.</p>
<p>Example:</p>
<pre><code class="language-clojure">(require '[shiftlefter.browser.ctx :as browser.ctx])

(def my-browser ...)
(set-ctx! :alice (browser.ctx/assoc-active-browser {} my-browser))

;; Now steps can use the browser
(as :alice "opens the browser to 'https://example.com'")
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L137">view source</a></div></div><div class="public anchor" id="var-shifted.21"><h3>shifted!</h3><div class="usage"><code>(shifted!)</code><code>(shifted! cfg)</code></div><div class="doc"><div class="markdown"><p>Enable Shifted mode with SVO validation.</p>
<p>With no argument, loads config from <code>shiftlefter.edn</code>. With a config map, uses that config directly.</p>
<p>In Shifted mode: - <code>run</code> and <code>run-dry</code> use SVO validation - <code>as</code> warns on unknown actor names</p>
<p>Returns: - {:status :ok :config {…}} on success - {:status :error …} if config loading fails</p>
<p>Example:</p>
<pre><code class="language-clojure">;; Load from shiftlefter.edn
(shifted!)

;; Use custom config
(shifted! {:svo {:unknown-subject :warn}
           :glossaries {:subjects "my/subjects.edn"}})

;; Check mode
(shifted?) ;; =&gt; true

;; Back to vanilla
(vanilla!)
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L213">view source</a></div></div><div class="public anchor" id="var-shifted.3F"><h3>shifted?</h3><div class="usage"><code>(shifted?)</code></div><div class="doc"><div class="markdown"><p>Returns true if REPL is in Shifted mode (SVO validation enabled).</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L208">view source</a></div></div><div class="public anchor" id="var-step"><h3>step</h3><div class="usage"><code>(step text)</code></div><div class="doc"><div class="markdown"><p>Execute a single step in step mode.</p>
<p>No Feature/Scenario structure required — just provide step text. Context accumulates across calls within a session.</p>
<p>Returns: - {:status :passed :ctx {…}} - {:status :failed :error {…} :ctx {…}} - {:status :pending :ctx {…}} - {:status :undefined :text “…”} - {:status :ambiguous :text “…” :matches <a href="...">…</a>}</p>
<p>Example:</p>
<pre><code class="language-clojure">(step "I have 12 cucumbers")
(step "I eat 5")
(step "I should have 7 left")

;; Check accumulated context
(ctx)

;; Reset for new session
(reset-ctx!)
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L502">view source</a></div></div><div class="public anchor" id="var-steps"><h3>steps</h3><div class="usage"><code>(steps)</code></div><div class="doc"><div class="markdown"><p>List all registered step patterns.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L493">view source</a></div></div><div class="public anchor" id="var-subjects"><h3>subjects</h3><div class="usage"><code>(subjects)</code></div><div class="doc"><div class="markdown"><p>Get known subject names from the glossary.</p>
<p>Returns a vector of subject keywords, or nil if not in Shifted mode.</p>
<p>Example:</p>
<pre><code class="language-clojure">(shifted! {:glossaries {:subjects "path/to/subjects.edn"}})
(subjects)
;; =&gt; [:alice :admin :guest]
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L288">view source</a></div></div><div class="public anchor" id="var-surface.3F"><h3>surface?</h3><div class="usage"><code>(surface? ctx-name)</code></div><div class="doc"><div class="markdown"><p>Returns true if the context name is marked as a surface.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L189">view source</a></div></div><div class="public anchor" id="var-unmark-surface.21"><h3>unmark-surface!</h3><div class="usage"><code>(unmark-surface! ctx-name)</code></div><div class="doc"><div class="markdown"><p>Unmark a context name as a surface.</p>
<p>After unmarking, the context will behave normally: reset/clear will close browser sessions instead of persisting them.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L180">view source</a></div></div><div class="public anchor" id="var-vanilla.21"><h3>vanilla!</h3><div class="usage"><code>(vanilla!)</code></div><div class="doc"><div class="markdown"><p>Disable Shifted mode, returning to vanilla mode.</p>
<p>In vanilla mode, SVO validation is disabled. Step execution proceeds without subject/verb/interface checks.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L253">view source</a></div></div><div class="public anchor" id="var-verbs"><h3>verbs</h3><div class="usage"><code>(verbs)</code><code>(verbs interface-type)</code></div><div class="doc"><div class="markdown"><p>Get known verb names from the glossary.</p>
<p>With no argument, returns a map of all interfaces to their verbs. With an interface-type argument, returns verbs for that interface.</p>
<p>Returns nil if not in Shifted mode.</p>
<p>Example:</p>
<pre><code class="language-clojure">(shifted! {:glossaries {:verbs {:web "path/to/verbs-web.edn"}}})
(verbs)
;; =&gt; {:web [:click :fill :see]}
(verbs :web)
;; =&gt; [:click :fill :see]
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/repl.clj#L303">view source</a></div></div></div></body></html>