<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>shiftlefter.webdriver.etaoin.session documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">ShiftLefter</span> <span class="project-version">0.3.6-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shiftlefter</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>adapters</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.adapters.etaoin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>etaoin</span></div></a></li><li class="depth-3"><a href="shiftlefter.adapters.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>browser</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.browser.chrome.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chrome</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.browser.ctx.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ctx</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.browser.locators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>locators</span></div></a></li><li class="depth-3"><a href="shiftlefter.browser.protocol.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocol</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>capabilities</span></div></div></li><li class="depth-3"><a href="shiftlefter.capabilities.ctx.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ctx</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>config</span></div></div></li><li class="depth-3"><a href="shiftlefter.config.user.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>user</span></div></a></li><li class="depth-2 branch"><a href="shiftlefter.core.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gherkin</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.compliance.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compliance</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.ddmin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ddmin</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.diagnostics.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>diagnostics</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.dialect.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dialect</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.fuzz.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fuzz</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.lexer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lexer</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.location.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>location</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.parser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parser</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.pickler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pickler</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.printer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>printer</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.tokens.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tokens</span></div></a></li><li class="depth-3"><a href="shiftlefter.gherkin.verify.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>verify</span></div></a></li><li class="depth-2 branch"><a href="shiftlefter.repl.html"><div class="inner"><span class="tree" style="top: -455px;"><span class="top" style="height: 464px;"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>runner</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.runner.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.runner.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.runner.discover.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>discover</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.runner.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>report</span></div></div></li><li class="depth-4 branch"><a href="shiftlefter.runner.report.console.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>console</span></div></a></li><li class="depth-4"><a href="shiftlefter.runner.report.edn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>edn</span></div></a></li><li class="depth-3"><a href="shiftlefter.runner.step-loader.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>step-loader</span></div></a></li><li class="depth-2 branch"><a href="shiftlefter.step.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>step</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stepdefs</span></div></div></li><li class="depth-3"><a href="shiftlefter.stepdefs.browser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>browser</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>stepengine</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.stepengine.bind.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bind</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.stepengine.compile.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compile</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.stepengine.exec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exec</span></div></a></li><li class="depth-3"><a href="shiftlefter.stepengine.macros.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>macros</span></div></a></li><li class="depth-4"><a href="shiftlefter.stepengine.macros.ini.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ini</span></div></a></li><li class="depth-3"><a href="shiftlefter.stepengine.registry.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-2"><a href="shiftlefter.subjects.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>subjects</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.subjects.browser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>browser</span></div></a></li><li class="depth-3"><a href="shiftlefter.subjects.profile.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>profile</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>svo</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.svo.extract.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extract</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.svo.glossary.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>glossary</span></div></a></li><li class="depth-3"><a href="shiftlefter.svo.validate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>validate</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>webdriver</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>etaoin</span></div></div></li><li class="depth-4 branch"><a href="shiftlefter.webdriver.etaoin.browser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>browser</span></div></a></li><li class="depth-4 current"><a href="shiftlefter.webdriver.etaoin.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-3"><a href="shiftlefter.webdriver.session-store.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>session-store</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-attach"><div class="inner"><span>attach</span></div></a></li><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-attached.3F"><div class="inner"><span>attached?</span></div></a></li><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-build-debugger-capabilities"><div class="inner"><span>build-debugger-capabilities</span></div></a></li><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-close-session.21"><div class="inner"><span>close-session!</span></div></a></li><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-connect-to-existing.21"><div class="inner"><span>connect-to-existing!</span></div></a></li><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-create-session.21"><div class="inner"><span>create-session!</span></div></a></li><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-detach"><div class="inner"><span>detach</span></div></a></li><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-ensure-session.21"><div class="inner"><span>ensure-session!</span></div></a></li><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-make-driver"><div class="inner"><span>make-driver</span></div></a></li><li class="depth-1"><a href="shiftlefter.webdriver.etaoin.session.html#var-probe-session.21"><div class="inner"><span>probe-session!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">shiftlefter.webdriver.etaoin.session</h1><div class="doc"><div class="markdown"><p>Etaoin session management helpers.</p>
<p>Provides attach/detach/close semantics for WebDriver sessions, enabling long-lived ‘browser surfaces’ and REPL workflows.</p>
<h2><a href="#pure-functions-no-http" id="pure-functions-no-http"></a>Pure Functions (no HTTP)</h2>
<ul>
<li><code>make-driver</code> — construct driver map from webdriver-url</li>
<li><code>attach</code> — set session-id on driver</li>
<li><code>detach</code> — remove session-id from driver</li>
</ul>
<h2><a href="#side-effecting-functions-webdriver-http" id="side-effecting-functions-webdriver-http"></a>Side-Effecting Functions (WebDriver HTTP)</h2>
<ul>
<li><code>create-session!</code> — create new session, returns EtaoinBrowser</li>
<li><code>connect-to-existing!</code> — connect to already-running Chrome via debuggerAddress</li>
<li><code>close-session!</code> — delete session remotely</li>
<li><code>probe-session!</code> — check if session is alive</li>
<li><code>ensure-session!</code> — use existing if alive, else create new</li>
</ul>
<h2><a href="#error-types" id="error-types"></a>Error Types</h2>
<ul>
<li><code>:webdriver/session-dead</code> — session no longer exists</li>
<li><code>:webdriver/attach-failed</code> — attach operation failed</li>
<li><code>:webdriver/close-failed</code> — close operation failed</li>
<li><code>:webdriver/create-failed</code> — session creation failed</li>
<li><code>:webdriver/connect-failed</code> — connection to existing Chrome failed</li>
</ul>
</div></div><div class="public anchor" id="var-attach"><h3>attach</h3><div class="usage"><code>(attach driver session-id)</code></div><div class="doc"><div class="markdown"><p>Attach an existing session ID to a driver (pure operation).</p>
<p>Returns the driver with :session set. Does not verify the session exists.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L51">view source</a></div></div><div class="public anchor" id="var-attached.3F"><h3>attached?</h3><div class="usage"><code>(attached? driver)</code></div><div class="doc"><div class="markdown"><p>Returns true if driver has a session attached.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L65">view source</a></div></div><div class="public anchor" id="var-build-debugger-capabilities"><h3>build-debugger-capabilities</h3><div class="usage"><code>(build-debugger-capabilities {:keys [port]})</code></div><div class="doc"><div class="markdown"><p>Build Chrome capabilities for connecting via debuggerAddress.</p>
<p>Options: - :port — Chrome debug port (required)</p>
<p>Note: Stealth options (excludeSwitches, useAutomationExtension) are NOT included here — they’re Chrome launch options, not WebDriver connect options. Stealth is applied when Chrome is launched (see browser.chrome/build-chrome-args).</p>
<p>Returns capabilities map suitable for Etaoin.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L113">view source</a></div></div><div class="public anchor" id="var-close-session.21"><h3>close-session!</h3><div class="usage"><code>(close-session! driver)</code></div><div class="doc"><div class="markdown"><p>Close/delete the remote WebDriver session.</p>
<p>Returns {:ok driver’} with session detached, or {:error {…}}.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L171">view source</a></div></div><div class="public anchor" id="var-connect-to-existing.21"><h3>connect-to-existing!</h3><div class="usage"><code>(connect-to-existing! {:keys [port stealth], :as opts})</code></div><div class="doc"><div class="markdown"><p>Connect to an already-running Chrome via debuggerAddress.</p>
<p>This creates a WebDriver session that attaches to Chrome running with <code>--remote-debugging-port=&lt;port&gt;</code>. Does NOT launch Chrome — assumes it’s already running (e.g., via <code>chrome/launch!</code>).</p>
<p>Options: - :port — Chrome debug port (required) - :stealth — if true, add anti-automation detection flags (default: false)</p>
<p>Returns: - Success: {:ok driver :browser EtaoinBrowser :etaoin-driver raw-driver} - Error: {:error {:type :webdriver/connect-failed …}}</p>
<p>Examples:</p>
<pre><code class="language-clojure">;; Chrome already running on port 9222
(connect-to-existing! {:port 9222 :stealth true})
;; =&gt; {:ok {...} :browser #EtaoinBrowser{...} :etaoin-driver {...}}
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L128">view source</a></div></div><div class="public anchor" id="var-create-session.21"><h3>create-session!</h3><div class="usage"><code>(create-session! driver)</code></div><div class="doc"><div class="markdown"><p>Create a new WebDriver session.</p>
<p>Returns {:ok driver’ :browser EtaoinBrowser :etaoin-driver raw-driver} or {:error {…}}.</p>
<p>The :browser key contains an EtaoinBrowser implementing IBrowser protocol, ready for use with browser stepdefs.</p>
<p>The driver must have :webdriver-url set (via make-driver).</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L74">view source</a></div></div><div class="public anchor" id="var-detach"><h3>detach</h3><div class="usage"><code>(detach driver)</code></div><div class="doc"><div class="markdown"><p>Detach session from driver (pure operation).</p>
<p>Returns the driver with :session removed. Does NOT close the remote session.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L58">view source</a></div></div><div class="public anchor" id="var-ensure-session.21"><h3>ensure-session!</h3><div class="usage"><code>(ensure-session! driver)</code></div><div class="doc"><div class="markdown"><p>Ensure driver has a valid session.</p>
<p>If driver has a session attached and it’s alive, returns {:ok driver}. If session is dead or not attached, creates a new session.</p>
<p>Returns {:ok driver’} or {:error {…}}.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L219">view source</a></div></div><div class="public anchor" id="var-make-driver"><h3>make-driver</h3><div class="usage"><code>(make-driver webdriver-url)</code><code>(make-driver webdriver-url opts)</code></div><div class="doc"><div class="markdown"><p>Construct a driver map from a webdriver URL.</p>
<p>The driver map is compatible with Etaoin but not yet connected to a session.</p>
<p>Options: - :capabilities — browser capabilities map (optional) - :headless — if true, run headless (default: false, i.e., headed)</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L32">view source</a></div></div><div class="public anchor" id="var-probe-session.21"><h3>probe-session!</h3><div class="usage"><code>(probe-session! driver)</code></div><div class="doc"><div class="markdown"><p>Check if the session is still alive.</p>
<p>Returns {:ok :alive} if session responds, or {:error {:type :webdriver/session-dead …}}.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/webdriver/etaoin/session.clj#L194">view source</a></div></div></div></body></html>