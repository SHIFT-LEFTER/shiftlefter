<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>shiftlefter.capabilities.ctx documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">ShiftLefter</span> <span class="project-version">0.3.6-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shiftlefter</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>adapters</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.adapters.etaoin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>etaoin</span></div></a></li><li class="depth-3"><a href="shiftlefter.adapters.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>browser</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.browser.chrome.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chrome</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.browser.ctx.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ctx</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.browser.locators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>locators</span></div></a></li><li class="depth-3"><a href="shiftlefter.browser.protocol.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocol</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>capabilities</span></div></div></li><li class="depth-3 current"><a href="shiftlefter.capabilities.ctx.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ctx</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>config</span></div></div></li><li class="depth-3"><a href="shiftlefter.config.user.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>user</span></div></a></li><li class="depth-2 branch"><a href="shiftlefter.core.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gherkin</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.compliance.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compliance</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.ddmin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ddmin</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.diagnostics.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>diagnostics</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.dialect.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dialect</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.fuzz.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fuzz</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.lexer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lexer</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.location.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>location</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.parser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parser</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.pickler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pickler</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.printer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>printer</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.gherkin.tokens.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tokens</span></div></a></li><li class="depth-3"><a href="shiftlefter.gherkin.verify.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>verify</span></div></a></li><li class="depth-2 branch"><a href="shiftlefter.repl.html"><div class="inner"><span class="tree" style="top: -455px;"><span class="top" style="height: 464px;"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>runner</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.runner.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.runner.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.runner.discover.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>discover</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.runner.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>report</span></div></div></li><li class="depth-4 branch"><a href="shiftlefter.runner.report.console.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>console</span></div></a></li><li class="depth-4"><a href="shiftlefter.runner.report.edn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>edn</span></div></a></li><li class="depth-3"><a href="shiftlefter.runner.step-loader.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>step-loader</span></div></a></li><li class="depth-2 branch"><a href="shiftlefter.step.html"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>step</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stepdefs</span></div></div></li><li class="depth-3"><a href="shiftlefter.stepdefs.browser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>browser</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>stepengine</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.stepengine.bind.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bind</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.stepengine.compile.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compile</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.stepengine.exec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exec</span></div></a></li><li class="depth-3"><a href="shiftlefter.stepengine.macros.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>macros</span></div></a></li><li class="depth-4"><a href="shiftlefter.stepengine.macros.ini.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ini</span></div></a></li><li class="depth-3"><a href="shiftlefter.stepengine.registry.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-2"><a href="shiftlefter.subjects.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>subjects</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.subjects.browser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>browser</span></div></a></li><li class="depth-3"><a href="shiftlefter.subjects.profile.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>profile</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>svo</span></div></div></li><li class="depth-3 branch"><a href="shiftlefter.svo.extract.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extract</span></div></a></li><li class="depth-3 branch"><a href="shiftlefter.svo.glossary.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>glossary</span></div></a></li><li class="depth-3"><a href="shiftlefter.svo.validate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>validate</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>webdriver</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>etaoin</span></div></div></li><li class="depth-4 branch"><a href="shiftlefter.webdriver.etaoin.browser.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>browser</span></div></a></li><li class="depth-4"><a href="shiftlefter.webdriver.etaoin.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-3"><a href="shiftlefter.webdriver.session-store.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>session-store</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-all-capabilities"><div class="inner"><span>all-capabilities</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-assoc-capability"><div class="inner"><span>assoc-capability</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-capability-key"><div class="inner"><span>capability-key</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-capability-names"><div class="inner"><span>capability-names</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-capability-present.3F"><div class="inner"><span>capability-present?</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-dissoc-capability"><div class="inner"><span>dissoc-capability</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-ephemeral-capabilities"><div class="inner"><span>ephemeral-capabilities</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-get-capability"><div class="inner"><span>get-capability</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-get-capability-entry"><div class="inner"><span>get-capability-entry</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-get-capability-mode"><div class="inner"><span>get-capability-mode</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-parse-capability-name"><div class="inner"><span>parse-capability-name</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-persistent-capabilities"><div class="inner"><span>persistent-capabilities</span></div></a></li><li class="depth-1"><a href="shiftlefter.capabilities.ctx.html#var-update-capability"><div class="inner"><span>update-capability</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">shiftlefter.capabilities.ctx</h1><div class="doc"><div class="markdown"><p>Generic capability helpers for ctx management.</p>
<p>Capabilities are stored in ctx under <code>:cap/&lt;interface-name&gt;</code> with the shape:</p>
<pre><code class="language-clj">{:cap/web {:impl &lt;browser-instance&gt;
           :mode :ephemeral}}
</code></pre>
<h2><a href="#capability-shape" id="capability-shape"></a>Capability Shape</h2>
<ul>
<li><code>:impl</code> — the capability implementation (e.g., EtaoinBrowser)</li>
<li><code>:mode</code> — <code>:ephemeral</code> (created per scenario) or <code>:persistent</code> (reused)</li>
</ul>
<h2><a href="#interface-names" id="interface-names"></a>Interface Names</h2>
<p>Interface names are keywords like <code>:web</code>, <code>:api</code>, <code>:sms</code>, <code>:email</code>. They correspond to interface config keys in <code>shiftlefter.edn</code>.</p>
<h2><a href="#usage" id="usage"></a>Usage</h2>
<pre><code class="language-clojure">(require '[shiftlefter.capabilities.ctx :as cap])

;; Check if capability exists
(cap/capability-present? ctx :web)  ;; =&gt; false

;; Store a capability
(def ctx2 (cap/assoc-capability ctx :web browser :ephemeral))

;; Retrieve it
(cap/get-capability ctx2 :web)  ;; =&gt; browser

;; Check mode
(cap/get-capability-mode ctx2 :web)  ;; =&gt; :ephemeral
</code></pre>
</div></div><div class="public anchor" id="var-all-capabilities"><h3>all-capabilities</h3><div class="usage"><code>(all-capabilities ctx)</code></div><div class="doc"><div class="markdown"><p>Returns a map of all capabilities in ctx.</p>
<p>Result shape: {:web {:impl … :mode …} :api {…} …}</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L169">view source</a></div></div><div class="public anchor" id="var-assoc-capability"><h3>assoc-capability</h3><div class="usage"><code>(assoc-capability ctx interface-name impl mode)</code><code>(assoc-capability ctx interface-name impl mode subject)</code></div><div class="doc"><div class="markdown"><p>Store a capability in ctx for the given interface name.</p>
<p>Parameters: - ctx: The context map - interface-name: Keyword like :web, :api - impl: The capability implementation - mode: :ephemeral or :persistent - subject: Optional subject keyword for per-subject storage</p>
<p>Returns updated ctx with capability stored under :cap/<interface-name> or :cap/<interface-name>.<subject>.</subject></interface-name></interface-name></p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L109">view source</a></div></div><div class="public anchor" id="var-capability-key"><h3>capability-key</h3><div class="usage"><code>(capability-key interface-name)</code><code>(capability-key interface-name subject)</code></div><div class="doc"><div class="markdown"><p>Construct the ctx key for a capability.</p>
<p>1-arity: interface only — :web =&gt; :cap/web 2-arity: interface + subject — :web :alice =&gt; :cap/web.alice</p>
<p>Subject-keyed capabilities allow multiple instances per interface (e.g., separate browsers for Alice and Bob).</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L43">view source</a></div></div><div class="public anchor" id="var-capability-names"><h3>capability-names</h3><div class="usage"><code>(capability-names ctx)</code></div><div class="doc"><div class="markdown"><p>Returns a vector of interface names that have capabilities in ctx.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L183">view source</a></div></div><div class="public anchor" id="var-capability-present.3F"><h3>capability-present?</h3><div class="usage"><code>(capability-present? ctx interface-name)</code><code>(capability-present? ctx interface-name subject)</code></div><div class="doc"><div class="markdown"><p>Returns true if ctx has a capability for the given interface name.</p>
<p>2-arity: checks interface only (:cap/web) 3-arity: checks interface+subject (:cap/web.alice)</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L62">view source</a></div></div><div class="public anchor" id="var-dissoc-capability"><h3>dissoc-capability</h3><div class="usage"><code>(dissoc-capability ctx interface-name)</code></div><div class="doc"><div class="markdown"><p>Remove a capability from ctx for the given interface name.</p>
<p>Returns updated ctx with capability removed.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L128">view source</a></div></div><div class="public anchor" id="var-ephemeral-capabilities"><h3>ephemeral-capabilities</h3><div class="usage"><code>(ephemeral-capabilities ctx)</code></div><div class="doc"><div class="markdown"><p>Returns interface names of all ephemeral capabilities in ctx.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L188">view source</a></div></div><div class="public anchor" id="var-get-capability"><h3>get-capability</h3><div class="usage"><code>(get-capability ctx interface-name)</code><code>(get-capability ctx interface-name subject)</code></div><div class="doc"><div class="markdown"><p>Returns the capability implementation for interface name, or nil if not present.</p>
<p>Returns the :impl value, not the full capability map. 3-arity version checks subject-keyed capability.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L78">view source</a></div></div><div class="public anchor" id="var-get-capability-entry"><h3>get-capability-entry</h3><div class="usage"><code>(get-capability-entry ctx interface-name)</code><code>(get-capability-entry ctx interface-name subject)</code></div><div class="doc"><div class="markdown"><p>Returns the full capability entry map {:impl … :mode …}, or nil if not present.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L96">view source</a></div></div><div class="public anchor" id="var-get-capability-mode"><h3>get-capability-mode</h3><div class="usage"><code>(get-capability-mode ctx interface-name)</code></div><div class="doc"><div class="markdown"><p>Returns the capability mode (:ephemeral or :persistent), or nil if not present.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L90">view source</a></div></div><div class="public anchor" id="var-parse-capability-name"><h3>parse-capability-name</h3><div class="usage"><code>(parse-capability-name cap-name)</code></div><div class="doc"><div class="markdown"><p>Parse a capability name into interface and optional subject.</p>
<p>:web        =&gt; {:interface :web :subject nil} :web.alice  =&gt; {:interface :web :subject :alice}</p>
<p>Used by cleanup to find the right interface config for subject-keyed capabilities.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L150">view source</a></div></div><div class="public anchor" id="var-persistent-capabilities"><h3>persistent-capabilities</h3><div class="usage"><code>(persistent-capabilities ctx)</code></div><div class="doc"><div class="markdown"><p>Returns interface names of all persistent capabilities in ctx.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L196">view source</a></div></div><div class="public anchor" id="var-update-capability"><h3>update-capability</h3><div class="usage"><code>(update-capability ctx interface-name new-impl)</code></div><div class="doc"><div class="markdown"><p>Update the implementation of an existing capability.</p>
<p>Preserves the mode. Returns ctx unchanged if capability doesn’t exist.</p>
</div></div><div class="src-link"><a href="https://github.com/SHIFT-LEFTER/shiftlefter/blob/v0.3.6-SNAPSHOT/src/shiftlefter/capabilities/ctx.clj#L136">view source</a></div></div></div></body></html>